{"version":3,"file":"hooks.server-d941252c.js","sources":["../../../.svelte-kit/adapter-node/chunks/hooks.server.js"],"sourcesContent":["import { r as redirect } from \"./index.js\";\nconst unProtectedRoutes = [\"/login\", \"/logout\"];\nconst pages = [\n  [\"/home\", \"/sales\"],\n  [\"/dashboard\", \"/report\"]\n];\nconst handle = async ({ event, resolve }) => {\n  const token = event.cookies.get(\"token\") || null;\n  if (event.url.pathname == \"/logout\") {\n    event.cookies.delete(\"token\");\n    event.cookies.delete(\"isadmin\");\n    event.cookies.delete(\"username\");\n    event.locals.user = null;\n    throw redirect(303, \"/login\");\n  }\n  const index = event.cookies.get(\"isadmin\") ? Number(event.cookies.get(\"isadmin\")) : 2;\n  event.locals.isadmin = index;\n  event.locals.token = token;\n  event.locals.username = event.cookies.get(\"username\") || \"\";\n  if (!unProtectedRoutes.includes(event.url.pathname) && !token || event.url.pathname === \"/logout\" && token) {\n    event.cookies.delete(\"token\");\n    event.locals.user = null;\n    throw redirect(303, \"/login\");\n  } else if (event.url.pathname === \"/\" && token) {\n    throw redirect(303, pages[index][0]);\n  }\n  return resolve(event);\n};\nconst handleFetch = async ({ request, fetch }) => {\n  const res = await fetch(request);\n  if ([401, 403, 205].includes(res.status)) {\n    throw redirect(303, \"/login\");\n  }\n  return res;\n};\nexport {\n  handle,\n  handleFetch\n};\n"],"names":[],"mappings":";;AACA,MAAM,iBAAiB,GAAG,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;AAChD,MAAM,KAAK,GAAG;AACd,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC;AACrB,EAAE,CAAC,YAAY,EAAE,SAAS,CAAC;AAC3B,CAAC,CAAC;AACG,MAAC,MAAM,GAAG,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK;AAC7C,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;AACnD,EAAE,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,IAAI,SAAS,EAAE;AACvC,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AAClC,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACpC,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;AACrC,IAAI,KAAK,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;AAC7B,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;AAClC,GAAG;AACH,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC;AACxF,EAAE,KAAK,CAAC,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;AAC/B,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;AAC7B,EAAE,KAAK,CAAC,MAAM,CAAC,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;AAC9D,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,KAAK,SAAS,IAAI,KAAK,EAAE;AAC9G,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AAClC,IAAI,KAAK,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;AAC7B,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;AAClC,GAAG,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,QAAQ,KAAK,GAAG,IAAI,KAAK,EAAE;AAClD,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACzC,GAAG;AACH,EAAE,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC;AACxB,EAAE;AACG,MAAC,WAAW,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK;AAClD,EAAE,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,OAAO,CAAC,CAAC;AACnC,EAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;AAC5C,IAAI,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;AAClC,GAAG;AACH,EAAE,OAAO,GAAG,CAAC;AACb;;;;"}